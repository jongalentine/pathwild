# ============================================
# PathWild Configuration
# ============================================

project:
  name: "PathWild"
  version: "0.1.0"
  description: "AI-powered wildlife location prediction"
  domain: "pathwild.ai"

# Data directories
data:
  raw_dir: "data/raw"
  processed_dir: "data/processed"
  features_dir: "data/features"
  
# Model configuration
models:
  dir: "models"
  mlflow_uri: "file:./mlruns"
  target_accuracy: 0.70
  
# AWS configuration
aws:
  region: "us-west-2"
  sagemaker_role: "arn:aws:iam::061861711395:role/PathWildSageMakerRole"
  s3_bucket: "pathwild-data"
  model_endpoint: "pathwild-elk-predictor"

# Species configuration
species:
  current:
    - elk_rocky_mountain
  planned:
    - deer_mule
    - deer_whitetail
    - waterfowl_various
    
# Geographic coverage
locations:
  current:
    - wyoming_usa
  planned:
    - montana_usa
    - colorado_usa
    - idaho_usa

# Hunt area configuration
hunt_areas:
  primary:
    area_id: "048"
    name: "Area 048"
    full_name: "Wyoming Hunt Area 048 (Leo-Hanna area)"
    county: "Carbon"
    center_lat: 41.8350
    center_lon: -106.4250
    size_sq_miles: 819.0
    size_acres: 524052.0
    # For exact polygon boundaries, download from WGFD GIS service
    # https://wgfd.wyo.gov/hunting/hunt-planner

# API configuration
api:
  host: "0.0.0.0"
  port: 5000
  debug: false
  
# Web application
web:
  domain: "pathwild.ai"
  title: "PathWild - AI Wildlife Prediction"
  tagline: "Predict. Plan. Succeed."

# Data pipeline configuration
appeears:
  username: ${APPEEARS_USERNAME}
  password: ${APPEEARS_PASSWORD}

prism:
  data_dir: data/prism
  variables: [tmean, tmin, tmax, ppt]

openmeteo:
  forecast_days: 7

# Google Earth Engine Configuration
gee:
  enabled: true  # Set to true to use GEE for NDVI (requires earthengine-api and authentication)
  project: spry-analyzer-283914  # GEE project ID (update to your project)
  collection: landsat8  # landsat8 | sentinel2
  batch_size: 100
  max_workers: 4
  buffer_days: 0  # 0 = use adaptive defaults (21 days for Landsat 5, 14 days for Landsat 8). Set to specific value to override.
  max_cloud_cover: 50.0  # Increased from 30.0 to find more images and reduce placeholder values

# Processing Configuration
processing:
  parallel_threshold: 5000  # Use parallel if > N records
  retry_attempts: 3
  retry_delay: 2.0

# Rut Behavior Configuration (Wyoming-specific)
rut_behavior:
  enabled: true
  timing:
    # Rut phases (month, start_day, month_end, end_day)
    pre_rut:
      start_month: 9
      start_day: 1
      end_month: 9
      end_day: 15
    peak_rut:
      start_month: 9
      start_day: 15
      end_month: 10
      end_day: 10
    post_rut:
      start_month: 10
      start_day: 10
      end_month: 10
      end_day: 31
  terrain_boosts:
    meadow_edge: 1.2      # 20% score boost
    ridgeline: 1.15        # 15% score boost
    elevated_viewpoint: 1.1  # 10% score boost
    aspen_stand: 1.1       # 10% score boost
    ecotone: 1.15          # 15% score boost
  elevation_preferences:
    optimal_low: 9000      # ft during rut
    optimal_high: 10000    # ft during rut
    acceptable_low: 8500   # ft
    acceptable_high: 10500 # ft
  security_importance:
    pre_rut_boost: 1.15    # 15% boost during pre-rut
    peak_rut_boost: 1.20   # 20% boost during peak rut (higher vulnerability)

# Area polygon configuration (example: Area 048)
area_048_polygon:
  - [-107.5, 44.3]
  - [-107.5, 44.7]
  - [-107.0, 44.7]
  - [-107.0, 44.3]
  - [-107.5, 44.3]

# Absence generation configuration
absence_generation:
  # Input paths (flexible - user configures these)
  input:
    presence_data_dir: "data/processed"
    presence_file_pattern: "presence_*.csv"
    # OR specify exact files (uncomment and modify as needed):
    # presence_files:
    #   - "data/processed/presence_north_bighorn.csv"
    #   - "data/processed/presence_south_bighorn.csv"
    #   - "data/processed/presence_national_refuge.csv"
    #   - "data/processed/presence_southern_gye.csv"
    
    # Geographic boundaries (for spatial sampling)
    study_area:
      # Auto-detect from presence data OR specify manually:
      bbox: null  # [min_lon, min_lat, max_lon, max_lat] or null to auto-detect
      shapefile: null  # Optional: Wyoming boundary shapefile path
    
    # DEM / elevation data (for unsuitable elevation strategy)
    dem_file: "data/dem/wyoming_dem.tif"  # Optional, used for elevation checks
  
  # Dataset-specific settings (allow per-dataset configuration)
  datasets:
    north_bighorn:
      enabled: true
      weight: 1.0  # Relative weight in combined dataset
      temporal_offset_months: 6  # For seasonal segregation
    
    south_bighorn:
      enabled: true
      weight: 1.0
      temporal_offset_months: 6
    
    national_refuge:
      enabled: true
      weight: 0.5  # Lower weight due to distance from Area 048
      temporal_offset_months: 6
    
    southern_gye:
      enabled: true
      weight: 0.5
      temporal_offset_months: 4  # Adjust based on seasonal timing
  
  # Absence generation strategies
  strategies:
    temporal_matched:
      enabled: true
      proportion: 0.40
      min_distance_from_presence_m: 2000
      elevation_range: [6000, 11000]  # ft (optional filter)
      max_slope_degrees: 45  # Optional filter
      max_water_distance_miles: 5  # Optional filter
    
    seasonal_segregation:
      enabled: true
      proportion: 0.30
      use_same_location: true
      offset_months: 6  # Default, can be overridden per dataset
      confidence: "high"
    
    unsuitable_temporal_environmental:
      enabled: true
      proportion: 0.20
      rules:
        winter_too_high:
          elevation_min: 9000  # ft
          months: [12, 1, 2, 3]
        summer_too_low:
          elevation_max: 6000  # ft
          months: [6, 7, 8]
        fall_too_high:
          elevation_min: 11000  # ft
          months: [9, 10, 11]
        fall_too_low:
          elevation_max: 5000  # ft
          months: [9, 10, 11]
      confidence: "high"
    
    random_background:
      enabled: true
      proportion: 0.10
      min_distance_from_presence_m: 500
      uniform_temporal: true  # Sample uniformly across all months
      confidence: "low"
  
  # Balance settings
  balance:
    ratio: 1.0  # absences:presences (1.0 = equal)
    per_dataset: false  # If true, balance each dataset separately
    global: true  # If true, balance across all datasets combined
  
  # Output settings
  output:
    directory: "data/processed"
    filename_pattern: "absence_{dataset}_{strategy}.csv"
    combined_filename: "combined_presence_absence.csv"
    save_separate_files: false  # Per-dataset files
    save_strategy_files: false  # Per-strategy files
    save_combined: true  # One combined file
    save_metadata: true
    save_validation_report: true
  
  # Feature enrichment (optional - handled by integrate_environmental_features.py)
  enrichment:
    enabled: false  # Set true to enrich with environmental features here
    use_data_context_builder: true
    batch_size: 1000
    retry_attempts: 3
    retry_delay_seconds: 5
    cache_static_features: true
  
  # Enable/disable temporal strategies
  use_temporal_strategies: true  # Enable enhanced temporal strategies (recommended)
  use_legacy_generators: false   # Keep old generators as fallback
